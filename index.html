<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Newsbuzz</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>Newsbuzz</h1>
    <select id="languageSwitcher">
      <option value="en">English</option>
      <option value="kn">Kannada</option>
      <option value="hi">Hindi</option>
    </select>
  </header>  <main>
    <section id="postForm">
      <input type="text" id="title" placeholder="Title" />
      <textarea id="content" placeholder="Content"></textarea>
      <input type="text" id="category" placeholder="Category" />
      <input type="text" id="location" placeholder="Location" />
      <input type="file" id="image" />
      <button onclick="submitPost()">Post</button>
    </section><section id="postsContainer"></section>

  </main>  <script>
    const apiBase = "https://newsbuzz-backend-tdzp.onrender.com";

    async function fetchPosts(lang = "en") {
      const res = await fetch(`${apiBase}/posts?lang=${lang}`);
      const posts = await res.json();
      const container = document.getElementById("postsContainer");
      container.innerHTML = "";
      posts.forEach(post => {
        const div = document.createElement("div");
        div.innerHTML = `
          <h2>${post.title}</h2>
          <img src="${post.imageUrl}" alt="Post image" width="200" />
          <p>${post.content}</p>
          <p><strong>${post.category} - ${post.location}</strong></p>
          <hr/>
        `;
        container.appendChild(div);
      });
    }

    async function submitPost() {
      const title = document.getElementById("title").value;
      const content = document.getElementById("content").value;
      const category = document.getElementById("category").value;
      const location = document.getElementById("location").value;
      const lang = document.getElementById("languageSwitcher").value;
      const image = document.getElementById("image").files[0];

      const formData = new FormData();
      formData.append("title", title);
      formData.append("content", content);
      formData.append("category", category);
      formData.append("location", location);
      formData.append("language", lang);
      formData.append("image", image);

      await fetch(`${apiBase}/posts`, {
        method: "POST",
        body: formData
      });

      fetchPosts(lang);
    }

    document.getElementById("languageSwitcher").addEventListener("change", (e) => {
      fetchPosts(e.target.value);
    });

    fetchPosts();
  </script></body>
</html>
